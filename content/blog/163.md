---
title:      Comparaison de classes
date:       2018-03-12
author:     Michel Casabianca
email:      michel.casabianca@gmail.com
id:         163
categories: []
tags:       [python]
lang:       fr
toc:        false
new:        true
---

Par défaut, Python compare les objets par leur adresse mémoire. Autrement dit, deux objets sont considérés comme égaux s'ils sont les mêmes. Souvent, on considère que deux objets sont identiques si tous leurs champs sont égaux.

<!--more-->

Pour implémenter cette comparaison, on doit écrire les méthodes *__eq__()* et *__ne__()*, comme suit :

```python
class Spam:

    def __init__(self, foo, bar):
        self.foo = foo
        self.bar = bar

    def __eq__(self, other):
        if isinstance(other, self.__class__):
            return self.foo == other.foo and self.bar == other.bar
        else:
            return False

    def __ne__(self, other):
        return not self.__eq__(other)
```

On peut améliorer ce code en comparant les dictionnaires de ces classes :

```python
class Spam:

    def __init__(self, foo, bar):
        self.foo = foo
        self.bar = bar

    def __eq__(self, other):
        if isinstance(other, self.__class__):
            return self.__dict__ == other.__dict__
        else:
            return False

    def __ne__(self, other):
        return not self.__eq__(other)
```

Mais on peut faire encore mieux en écrivant un *Mixin* :

```python
class EqualMixin:

    def __eq__(self, other):
        if isinstance(other, self.__class__):
            return self.__dict__ == other.__dict__
        else:
            return False

    def __ne__(self, other):
        return not self.__eq__(other)
```

Un mixin est une classe qui implémente une fonctionnalité. On en héritera pour ajouter cette fonctionnalité à une classe. Dans la mesure où l'héritage multiple est possible en Python, on peut ainsi ajouter des fonctionnalités dans une classe.

```python
class Spam(EqualMixin):

    def __init__(self, foo, bar):
        self.foo = foo
        self.bar = bar
```

Cette classe permet ainsi de simplifier les tests unitaires, on pourra tester simplement des classes avec de simples *assertEqual()*.

*Enjoy!*
